<!DOCTYPE html>
<html lang="fa">
<head>
  	<title>تست رگرسیون با Siege</title>

	<link rel="stylesheet" href="/theme/css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="/theme/css/bootstrap-rtl.css" type="text/css" />
	<link rel="stylesheet" href="/theme/css/pygments.css" type="text/css" />
	<link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
	<link rel="stylesheet" href="/theme/css/Vazir.css" type="text/css" />
	<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>
	<script>
  		$(document).ready(function () {
    		$(".post table").addClass("table table-striped table-condensed table-bordered");
  	  	});
    </script>
	<meta charset="utf-8" />

	<link rel="alternate" href="/feeds/all.atom.xml" type="application/atom+xml" title="خبرخوان رگانتو -یادداشت‌های مرتضی سلسله " />
    <meta name="description" content="یادداشت‌های مرتضی سلسله">
	<meta name="keywords" content="python, django, tornado, software, software architecture, clean architecture, software design, reganto, murtaza selseleh">
	<meta name="google-site-verification" content="qsVGVu_-AAkJs98yNa_4PU3KkEz1Bam-dNOyEUeCyZI" />
	<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">


    <meta name="tags" content="test" />
    <meta name="tags" content="regression testing" />
    <meta name="tags" content="siege" />
</head>
<body>
	<div class="wrap">
		<div class="container">
			<div class="banner">
				<a href="/">رگانتو</a>
				<h1>یادداشت‌های مرتضی سلسله</h1>
			</div>
<div class="content">
	<div class="post">
		<h3>
			تست رگرسیون با Siege
		</h3>
		<div class="info">
			چهارشنبه 28 اردیبهشت 1401
				توسط <a class="url fn" href="/author/reganto.html">Reganto</a>
		</div>
		<div class="content">
			<p>وقتی یک برنامه تحت وب شروع به کار می‌کند شاید در نگاه اول همه چیز خوب به نظر برسد اما با رشد کاربران و افزایش ترافیک، سیستم چگونه کار خواهد کرد؟اگر برنامه تحت وب را یک جعبه در نظر بگیریم،‌درخواست به برنامه ارسال می‌شود،‌درخواست پردازش می‌شود ودر نهایت پاسخی نمایش داده می شود.با ابزار siege می‌توانیم regression test , load test, stress test را به خوبی انجام دهیم.
فرض کنید می‌خواهید برنامه ی تحت وب خود را برای یک میلیون کاربر آماده کنید.برای تست این برنامه دو راه وجود دارد، راه اول این است که از یک میلیون کاربر بخواهید که برنامه ی شما را تست کنند و راه دوم شبیه سازی این تعداد کاربر است.</p>
<h3>انواع تست کارایی</h3>
<p><strong>Load test:</strong>
وقتی که برنامه تحت وب را برای تعداد مشخص و از قبل تعیین شده‌ای از درخواست ها تست می‌کنیم،‌به این نوع تست load test می گویند.</p>
<p><strong>Stress test:</strong>
اگر تعداد درخواست از سطح مشخص شده فراتر رود در این صورت تست را stress test می گویند.</p>
<p><strong>Regression test:</strong>
وقتی تغییری در نرم‌افزار داده می شود،چگونه بفهمیم کارایی نرم‌افزار کاهش نیافته است؟ برای حصول اطمینان از یکسان بودن کارایی سرور قبل و بعد از تغییر، ‌regression test انجام می شود. اگر بخواهیم زیرساخت ها ی پروژه را تغییر دهیم دوباره به regression test نیاز خواهیم داشت. فرض کنید پروژه بر روی وب سرور Apache باشد و بخواهیم وب سرور را به Nginx تغییر دهیم. قبل از تغییر وب سرور ‌برنامه به صورت میانگین قادر به مدیریت N در خواست در دقیقه است. از کجا معلوم که با تغییر وب سرور کارایی برنامه کاهش نیابد و همچنان N درخواست در دقیقه قابل مدیریت باشد؟</p>
<h3>مراحل انجام یک تست موفق:</h3>
<p><strong>برنامه ریزی:</strong>
در این مرحله باید به سؤالاتی از این قبیل پاسخ داده شود: چه چیزی باید تست شود؟ چه انتظاری از تست وجود دارد؟ ترافیک روی سرور چقدر باید باشد؟ تست بر روی کدام آدرس باید انجام شود؟ و . . .</p>
<p><strong>آماده سازی:</strong>
در این مرحله باید از ایزوله بودن محیط تست اطمینان حاصل شود. برای انجام تست های بعدی هم از همین محیط ایزوله استفاده می‌شود.</p>
<p><strong>آنالیز:</strong>
نتایج حاصل از تست باید مورد ارزیابی دقیق قرار گیرند.</p>
<h3>شروع کار با Siege:</h3>
<p>ابزاری فوق‌العاده برای بنچمارک گیری و تست اپلیکیشن های تحت وب است. این ابزار کاربران همزمان را برای تست اپ های تحت وب شبیه سازی می کند.</p>
<p><strong>نصب:</strong>
در توزیع ابونتو ابزار siege بدین صورت نصب می شود:«البته با نصب از طریق مخازن اصلی ابونتو، جدیدترین ورژن نصب نخواهد شد»</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>siege
</code></pre></div>

<p><strong>ایجاد سرور آزمایشی:</strong>
برای ایجاد یک سرور آزمایشی تنها کافی است کد زیر را تایپ کنید:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span>PORT
</code></pre></div>

<p>به جای PORT باید پورت مورد نظر خود برای اجرای سرور را وارد کنید.</p>
<p><strong>اصول اولیه کار با siege:</strong></p>
<p>برای شروع کار دستورات زیر را در شل اجرا کنید:</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>URL
</code></pre></div>

<p>به جای URL باید آدرس مورد نظر جایگزین شود. در این صورت تست با پارامتر های پیش‌فرض انجام می شود. برای اتمام تست از کلید های ترکیبی CTRL+C استفاده کنید.</p>
<p><strong>اولین تست:</strong></p>
<p>فرض کنید سرور را بر روی پورت 8888 اجرا کرده‌ایم. حال با استفاده از siege سرور را تست می‌کنیم.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span>http://localhost:8888/
</code></pre></div>

<p>خروجی به صورت زیر است:</p>
<div class="highlight"><pre><span></span><code>**<span class="w"> </span>SIEGE<span class="w"> </span><span class="m">4</span>.0.4
**<span class="w"> </span>Preparing<span class="w"> </span><span class="m">1</span><span class="w"> </span>concurrent<span class="w"> </span>users<span class="w"> </span><span class="k">for</span><span class="w"> </span>battle.
The<span class="w"> </span>server<span class="w"> </span>is<span class="w"> </span>now<span class="w"> </span>under<span class="w"> </span>siege...
Transactions:<span class="w">                      </span><span class="m">1</span><span class="w"> </span>hits
Availability:<span class="w">                 </span><span class="m">100</span>.00<span class="w"> </span>%
Elapsed<span class="w"> </span>time:<span class="w">                   </span><span class="m">0</span>.00<span class="w"> </span>secs
Data<span class="w"> </span>transferred:<span class="w">               </span><span class="m">0</span>.00<span class="w"> </span>MB
Response<span class="w"> </span>time:<span class="w">                  </span><span class="m">0</span>.00<span class="w"> </span>secs
Transaction<span class="w"> </span>rate:<span class="w">               </span><span class="m">0</span>.00<span class="w"> </span>trans/sec
Throughput:<span class="w">                     </span><span class="m">0</span>.00<span class="w"> </span>MB/sec
Concurrency:<span class="w">                    </span><span class="m">0</span>.00
Successful<span class="w"> </span>transactions:<span class="w">           </span><span class="m">1</span>
Failed<span class="w"> </span>transactions:<span class="w">               </span><span class="m">0</span>
Longest<span class="w"> </span>transaction:<span class="w">            </span><span class="m">0</span>.00
Shortest<span class="w"> </span>transaction:<span class="w">           </span><span class="m">0</span>.00
</code></pre></div>

<p>آرگومان <code>r-</code> تعداد تکرار تست را تعیین می‌کند. آرگومان <code>c-</code> تعداد کاربران شبیه‌سازی شده را مشخص می‌کند. پس تعداد درخواست‌های فرستاده شده به سمت سرور برابر ضرب مقدار این دو آرگومان خواهد شد.</p>
<p><strong>تحلیل خروجی تست:</strong></p>
<p><strong>Transaction:</strong>
برای هر کلاینت از طرف سرور یک سوکت باز می شود،‌ درخواست مدیریت می شود،‌ پاسخ برگشت داده می‌شود و درنهایت سوکت بسته می شود. این ها کارهایی است که در یک تراکنش انجام می شود. این مورد تعداد درخواست‌های فرستاده شده به سمت سرور را مشخص می‌کند.</p>
<p><strong>Availability:</strong>
درصد درخواست‌هایی است که با موفقیت توسط سرور مدیریت شده اند.</p>
<p><strong>Elapsed time:</strong>
زمان انجام تست است.</p>
<p><strong>Data transferred:</strong>
مجموع داده‌هایی است که از طرف سرور به هر کاربر شبیه سازی شده ارسال شده است.</p>
<p><strong>Response time:</strong>
میانگین زمانی برای پاسخ به درخواست یک کاربر شبیه سازی شده است.</p>
<p><strong>Transaction rate:</strong>
میانگین تعداد تراکنش هایی است که سرور می‌تواند در یک ثانیه مدیریت کند(Transaction / Elapsed time)</p>
<p><strong>Throughput:</strong>
میانگین تعداد بایت هایی است که در هر ثانیه از سرور به تمام کاربران شبیه سازی شده انتقال می یابد.</p>
<p><strong>Concurrency:</strong>
حاصل تقسیم تعداد کل تراکنش ها به زمان کل سپری شده است(Transaction/ Elapsed time ).هر چه این عدد بزرگ‌تر باشد،‌کارایی سرور کم‌تر است.</p>
<p><strong>Successful transactions:</strong>
تعداد دفعاتی که کد پاسخ(response code)برگشت داده شده از طرف سرور کوچک تر از 400 است.(تراکنش با موفقیت انجام شده باشد)</p>
<p><strong>Failed transactions:</strong>
تعداد دفعاتی که کد پاسخ برگشت داده شده از طرف سرور بزرگ‌تر یا مساوی 400 باشد به علاوه تراکنش هایی که اصطلاحاً timeout می شوند.</p>
<p><strong>Longest transaction:</strong>
بیشترین زمانی که یک تراکنش طول کشیده است.</p>
<p><strong>Shortest transaction:</strong>
کم‌ترین زمانی که یک تراکنش طول کشیده است.</p>
<p><strong>سوئیچ‌های siege</strong></p>
<p>در این قسمت سوئیچ های ابزار siege را مورد بررسی قرار خواهیم داد. با سوئیچ h- هلپ ابزار نمایش داده می شود.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-h
</code></pre></div>

<p>خروجی به صورت زیر خواهد بود:</p>
<div class="highlight"><pre><span></span><code>Usage:<span class="w"> </span>siege<span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
<span class="w">       </span>siege<span class="w"> </span><span class="o">[</span>options<span class="o">]</span><span class="w"> </span>URL
<span class="w">       </span>siege<span class="w"> </span>-g<span class="w"> </span>URL
Options:
<span class="w">  </span>-V,<span class="w"> </span>--version<span class="w">             </span>VERSION,<span class="w"> </span>prints<span class="w"> </span>the<span class="w"> </span>version<span class="w"> </span>number.
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">                </span>HELP,<span class="w"> </span>prints<span class="w"> </span>this<span class="w"> </span>section.
<span class="w">  </span>-C,<span class="w"> </span>--config<span class="w">              </span>CONFIGURATION,<span class="w"> </span>show<span class="w"> </span>the<span class="w"> </span>current<span class="w"> </span>config.
<span class="w">  </span>-v,<span class="w"> </span>--verbose<span class="w">             </span>VERBOSE,<span class="w"> </span>prints<span class="w"> </span>notification<span class="w"> </span>to<span class="w"> </span>screen.
<span class="w">  </span>-q,<span class="w"> </span>--quiet<span class="w">               </span>QUIET<span class="w"> </span>turns<span class="w"> </span>verbose<span class="w"> </span>off<span class="w"> </span>and<span class="w"> </span>suppresses<span class="w"> </span>output.
<span class="w">  </span>-g,<span class="w"> </span>--get<span class="w">                 </span>GET,<span class="w"> </span>pull<span class="w"> </span>down<span class="w"> </span>HTTP<span class="w"> </span>headers<span class="w"> </span>and<span class="w"> </span>display<span class="w"> </span>the
<span class="w">                            </span>transaction.<span class="w"> </span>Great<span class="w"> </span><span class="k">for</span><span class="w"> </span>application<span class="w"> </span>debugging.
<span class="w">  </span>-p,<span class="w"> </span>--print<span class="w">               </span>PRINT,<span class="w"> </span>like<span class="w"> </span>GET<span class="w"> </span>only<span class="w"> </span>it<span class="w"> </span>prints<span class="w"> </span>the<span class="w"> </span>entire<span class="w"> </span>page.
<span class="w">  </span>-c,<span class="w"> </span>--concurrent<span class="o">=</span>NUM<span class="w">      </span>CONCURRENT<span class="w"> </span>users,<span class="w"> </span>default<span class="w"> </span>is<span class="w"> </span><span class="m">10</span>
<span class="w">  </span>-r,<span class="w"> </span>--reps<span class="o">=</span>NUM<span class="w">            </span>REPS,<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span><span class="nb">times</span><span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>test.
<span class="w">  </span>-t,<span class="w"> </span>--time<span class="o">=</span>NUMm<span class="w">           </span>TIMED<span class="w"> </span>testing<span class="w"> </span>where<span class="w"> </span><span class="s2">&quot;m&quot;</span><span class="w"> </span>is<span class="w"> </span>modifier<span class="w"> </span>S,<span class="w"> </span>M,<span class="w"> </span>or<span class="w"> </span>H
<span class="w">                            </span>ex:<span class="w"> </span>--time<span class="o">=</span>1H,<span class="w"> </span>one<span class="w"> </span>hour<span class="w"> </span>test.
<span class="w">  </span>-d,<span class="w"> </span>--delay<span class="o">=</span>NUM<span class="w">           </span>Time<span class="w"> </span>DELAY,<span class="w"> </span>random<span class="w"> </span>delay<span class="w"> </span>before<span class="w"> </span>each<span class="w"> </span>requst
<span class="w">  </span>-b,<span class="w"> </span>--benchmark<span class="w">           </span>BENCHMARK:<span class="w"> </span>no<span class="w"> </span>delays<span class="w"> </span>between<span class="w"> </span>requests.
<span class="w">  </span>-i,<span class="w"> </span>--internet<span class="w">            </span>INTERNET<span class="w"> </span>user<span class="w"> </span>simulation,<span class="w"> </span>hits<span class="w"> </span>URLs<span class="w"> </span>randomly.
<span class="w">  </span>-f,<span class="w"> </span>--file<span class="o">=</span>FILE<span class="w">           </span>FILE,<span class="w"> </span><span class="k">select</span><span class="w"> </span>a<span class="w"> </span>specific<span class="w"> </span>URLS<span class="w"> </span>FILE.
<span class="w">  </span>-R,<span class="w"> </span>--rc<span class="o">=</span>FILE<span class="w">             </span>RC,<span class="w"> </span>specify<span class="w"> </span>an<span class="w"> </span>siegerc<span class="w"> </span>file
<span class="w">  </span>-l,<span class="w"> </span>--log<span class="o">[=</span>FILE<span class="o">]</span><span class="w">          </span>LOG<span class="w"> </span>to<span class="w"> </span>FILE.<span class="w"> </span>If<span class="w"> </span>FILE<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>specified,<span class="w"> </span>the
<span class="w">                            </span>default<span class="w"> </span>is<span class="w"> </span>used:<span class="w"> </span>/var/log/siege.log
<span class="w">  </span>-m,<span class="w"> </span>--mark<span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w">         </span>MARK,<span class="w"> </span>mark<span class="w"> </span>the<span class="w"> </span>log<span class="w"> </span>file<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>string.
<span class="w">                            </span>between<span class="w"> </span>.001<span class="w"> </span>and<span class="w"> </span>NUM.<span class="w"> </span><span class="o">(</span>NOT<span class="w"> </span>COUNTED<span class="w"> </span>IN<span class="w"> </span>STATS<span class="o">)</span>
<span class="w">  </span>-H,<span class="w"> </span>--header<span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w">       </span>Add<span class="w"> </span>a<span class="w"> </span>header<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span><span class="o">(</span>can<span class="w"> </span>be<span class="w"> </span>many<span class="o">)</span>
<span class="w">  </span>-A,<span class="w"> </span>--user-agent<span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w">   </span>Sets<span class="w"> </span>User-Agent<span class="w"> </span><span class="k">in</span><span class="w"> </span>request
<span class="w">  </span>-T,<span class="w"> </span>--content-type<span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="w"> </span>Sets<span class="w"> </span>Content-Type<span class="w"> </span><span class="k">in</span><span class="w"> </span>request
<span class="w">      </span>--no-parser<span class="w">           </span>NO<span class="w"> </span>PARSER,<span class="w"> </span>turn<span class="w"> </span>off<span class="w"> </span>the<span class="w"> </span>HTML<span class="w"> </span>page<span class="w"> </span>parser
<span class="w">      </span>--no-follow<span class="w">           </span>NO<span class="w"> </span>FOLLOW,<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>follow<span class="w"> </span>HTTP<span class="w"> </span>redirects

Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">2017</span><span class="w"> </span>by<span class="w"> </span>Jeffrey<span class="w"> </span>Fulmer,<span class="w"> </span>et<span class="w"> </span>al.
This<span class="w"> </span>is<span class="w"> </span>free<span class="w"> </span>software<span class="p">;</span><span class="w"> </span>see<span class="w"> </span>the<span class="w"> </span><span class="nb">source</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>copying<span class="w"> </span>conditions.
There<span class="w"> </span>is<span class="w"> </span>NO<span class="w"> </span>warranty<span class="p">;</span><span class="w"> </span>not<span class="w"> </span>even<span class="w"> </span><span class="k">for</span><span class="w"> </span>MERCHANTABILITY<span class="w"> </span>or<span class="w"> </span>FITNESS
FOR<span class="w"> </span>A<span class="w"> </span>PARTICULAR<span class="w"> </span>PURPOSE.
</code></pre></div>

<p>اولین سوئیچ V- است. اگر ابزار با این سوئیچ اجرا شود،‌ ورژن ابزار و کپی رایت مربوط به آن نمایش داده می شود. </p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-V
</code></pre></div>

<p>خروجی به صورت زیر خواهد بود:</p>
<div class="highlight"><pre><span></span><code>SIEGE<span class="w"> </span><span class="m">4</span>.0.4

Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">2017</span><span class="w"> </span>by<span class="w"> </span>Jeffrey<span class="w"> </span>Fulmer,<span class="w"> </span>et<span class="w"> </span>al.
This<span class="w"> </span>is<span class="w"> </span>free<span class="w"> </span>software<span class="p">;</span><span class="w"> </span>see<span class="w"> </span>the<span class="w"> </span><span class="nb">source</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>copying<span class="w"> </span>conditions.
There<span class="w"> </span>is<span class="w"> </span>NO<span class="w"> </span>warranty<span class="p">;</span><span class="w"> </span>not<span class="w"> </span>even<span class="w"> </span><span class="k">for</span><span class="w"> </span>MERCHANTABILITY<span class="w"> </span>or<span class="w"> </span>FITNESS
FOR<span class="w"> </span>A<span class="w"> </span>PARTICULAR<span class="w"> </span>PURPOSE.
</code></pre></div>

<p>سوئیچ بعدی C- است. این سوئیچ تنظیماتی را که ابزار با آن اجرا می شود را نمایش می دهد.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-C
</code></pre></div>

<p>خروجی به صورت زیر خواهد بود:</p>
<div class="highlight"><pre><span></span><code>CURRENT<span class="w">  </span>SIEGE<span class="w">  </span>CONFIGURATION
Mozilla/5.0<span class="w"> </span><span class="o">(</span>pc-x86_64-linux-gnu<span class="o">)</span><span class="w"> </span>Siege/4.0.4
Edit<span class="w"> </span>the<span class="w"> </span>resource<span class="w"> </span>file<span class="w"> </span>to<span class="w"> </span>change<span class="w"> </span>the<span class="w"> </span>settings.
----------------------------------------------
version:<span class="w">                        </span><span class="m">4</span>.0.4
verbose:<span class="w">                        </span><span class="nb">false</span>
color:<span class="w">                          </span><span class="nb">true</span>
quiet:<span class="w">                          </span><span class="nb">false</span>
debug:<span class="w">                          </span><span class="nb">false</span>
protocol:<span class="w">                       </span>HTTP/1.1
HTML<span class="w"> </span>parser:<span class="w">                    </span>enabled
get<span class="w"> </span>method:<span class="w">                     </span>HEAD
connection:<span class="w">                     </span>close
concurrent<span class="w"> </span>users:<span class="w">               </span><span class="m">25</span>
<span class="nb">time</span><span class="w"> </span>to<span class="w"> </span>run:<span class="w">                    </span>n/a
repetitions:<span class="w">                    </span>n/a
socket<span class="w"> </span>timeout:<span class="w">                 </span><span class="m">30</span>
cache<span class="w"> </span>enabled:<span class="w">                  </span><span class="nb">false</span>
accept-encoding:<span class="w">                </span>gzip,<span class="w"> </span>deflate
delay:<span class="w">                          </span><span class="m">0</span>.000<span class="w"> </span>sec
internet<span class="w"> </span>simulation:<span class="w">            </span><span class="nb">false</span>
benchmark<span class="w"> </span>mode:<span class="w">                 </span><span class="nb">false</span>
failures<span class="w"> </span><span class="k">until</span><span class="w"> </span>abort:<span class="w">           </span><span class="m">1024</span>
named<span class="w"> </span>URL:<span class="w">                      </span>none
URLs<span class="w"> </span>file:<span class="w">                      </span>/etc/siege/urls.txt
thread<span class="w"> </span>limit:<span class="w">                   </span><span class="m">255</span>
logging:<span class="w">                        </span><span class="nb">false</span>
log<span class="w"> </span>file:<span class="w">                       </span>/var/log/log/siege.log
resource<span class="w"> </span>file:<span class="w">                  </span>/home/reganto/.siege/siege.conf
timestamped<span class="w"> </span>output:<span class="w">             </span><span class="nb">false</span>
comma<span class="w"> </span>separated<span class="w"> </span>output:<span class="w">         </span><span class="nb">false</span>
allow<span class="w"> </span>redirects:<span class="w">                </span><span class="nb">true</span>
allow<span class="w"> </span>zero<span class="w"> </span>byte<span class="w"> </span>data:<span class="w">           </span><span class="nb">true</span>
allow<span class="w"> </span>chunked<span class="w"> </span>encoding:<span class="w">         </span><span class="nb">true</span>
upload<span class="w"> </span>unique<span class="w"> </span>files:<span class="w">            </span><span class="nb">true</span>
no-follow:
<span class="w"> </span>-<span class="w"> </span>ad.doubleclick.net
<span class="w"> </span>-<span class="w"> </span>pagead2.googlesyndication.com
<span class="w"> </span>-<span class="w"> </span>ads.pubsqrd.com
<span class="w"> </span>-<span class="w"> </span>ib.adnxs.com
</code></pre></div>

<p>سوئیچ بعدی v- است. اگر ابزار با این سوئیچ اجرا شود،‌ابزار اصطلاحا verbose خواهد بود. دراین حالت تمام اکشن هایی که توسط ابزار انجام می شود،‌در صفحه نمایش نشان داده می شود. تست سوئیچ v- را با یک کاربر شبیه سازی شده و به مدت ۵ ثانیه بر روی گوگل انجام می دهیم .</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-t<span class="w"> </span>5S<span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>با آرگومان t- می‌توان زمان انجام تست را تعیین کرد. (S برای ثانیه، M برای دقیقه , H برای ساعت)</p>
<blockquote>
<p>حتما متوجه شده‌اید که از این ابزار برای حملات <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack">DOS</a> نیز می‌توان استفاده کرد پس زمان تست را افزایش ندهید.</p>
</blockquote>
<p>خروجی:</p>
<div class="highlight"><pre><span></span><code>**<span class="w"> </span>SIEGE<span class="w"> </span><span class="m">4</span>.0.4<span class="w">                                                     </span>
**<span class="w"> </span>Preparing<span class="w"> </span><span class="m">1</span><span class="w"> </span>concurrent<span class="w"> </span>users<span class="w"> </span><span class="k">for</span><span class="w"> </span>battle.
The<span class="w"> </span>server<span class="w"> </span>is<span class="w"> </span>now<span class="w"> </span>under<span class="w"> </span>siege...
HTTP/1.1<span class="w"> </span><span class="m">301</span><span class="w">     </span><span class="m">1</span>.26<span class="w"> </span>secs:<span class="w">     </span><span class="m">220</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>GET<span class="w">  </span>/
HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w">     </span><span class="m">1</span>.11<span class="w"> </span>secs:<span class="w">   </span><span class="m">16557</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>GET<span class="w">  </span>/
HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w">     </span><span class="m">0</span>.65<span class="w"> </span>secs:<span class="w">    </span><span class="m">5482</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>GET<span class="w">  </span>/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png
HTTP/1.1<span class="w"> </span><span class="m">301</span><span class="w">     </span><span class="m">0</span>.88<span class="w"> </span>secs:<span class="w">     </span><span class="m">220</span><span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>GET<span class="w">  </span>/

Lifting<span class="w"> </span>the<span class="w"> </span>server<span class="w"> </span>siege...
Transactions:<span class="w">                      </span><span class="m">3</span><span class="w"> </span>hits
Availability:<span class="w">                 </span><span class="m">100</span>.00<span class="w"> </span>%
Elapsed<span class="w"> </span>time:<span class="w">                   </span><span class="m">4</span>.64<span class="w"> </span>secs
Data<span class="w"> </span>transferred:<span class="w">               </span><span class="m">0</span>.02<span class="w"> </span>MB
Response<span class="w"> </span>time:<span class="w">                  </span><span class="m">1</span>.30<span class="w"> </span>secs
Transaction<span class="w"> </span>rate:<span class="w">               </span><span class="m">0</span>.65<span class="w"> </span>trans/sec
Throughput:<span class="w">                     </span><span class="m">0</span>.00<span class="w"> </span>MB/sec
Concurrency:<span class="w">                    </span><span class="m">0</span>.84
Successful<span class="w"> </span>transactions:<span class="w">           </span><span class="m">4</span>
Failed<span class="w"> </span>transactions:<span class="w">               </span><span class="m">0</span>
Longest<span class="w"> </span>transaction:<span class="w">            </span><span class="m">1</span>.26
Shortest<span class="w"> </span>transaction:<span class="w">           </span><span class="m">0</span>.65
</code></pre></div>

<p>همانطور که می‌بینید خروجی به صورت verbose نمایش داده شده است.</p>
<p>سوئیچ بعدی q- است. این سوئیچ مخالف سوئیچ قبلی است. اگر تست با این سوئیچ انجام شود،‌هیچگونه خروجی ای در صفحه نمایش ظاهر نمی شود(پیام اتمام فرایند تست در خروجی نمایش داده می شود)</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-t<span class="w"> </span>5S<span class="w"> </span>-q<span class="w"> </span>https://google.com/
</code></pre></div>

<p>خروجی به صورت زیر خواهد بود:</p>
<div class="highlight"><pre><span></span><code>Lifting<span class="w"> </span>the<span class="w"> </span>server<span class="w"> </span>siege...
</code></pre></div>

<p>سوئیچ بعدی g- است. اگر تست با این سوئیچ اجرا شود،‌ Request Headers و Response Headers  به همراه خروجی تست نمایش داده می شوند.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span>-g<span class="w"> </span>https://google.com/
</code></pre></div>

<p>خروجی به صورت زیر خواهد بود:</p>
<div class="highlight"><pre><span></span><code>HEAD<span class="w"> </span>/<span class="w"> </span>HTTP/1.0
Host:<span class="w"> </span>google.com
Accept:<span class="w"> </span>*/*
Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate
User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>pc-x86_64-linux-gnu<span class="o">)</span><span class="w"> </span>Siege/4.0.4
Connection:<span class="w"> </span>close


HTTP/1.0<span class="w"> </span><span class="m">301</span><span class="w"> </span>Moved<span class="w"> </span>Permanently
Location:<span class="w"> </span>https://www.google.com/
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8
Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">18</span><span class="w"> </span>May<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">13</span>:58:15<span class="w"> </span>GMT
Expires:<span class="w"> </span>Fri,<span class="w"> </span><span class="m">17</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">13</span>:58:15<span class="w"> </span>GMT
Cache-Control:<span class="w"> </span>public,<span class="w"> </span>max-age<span class="o">=</span><span class="m">2592000</span>
Server:<span class="w"> </span>gws
Content-Length:<span class="w"> </span><span class="m">220</span>
X-XSS-Protection:<span class="w"> </span><span class="m">0</span>
X-Frame-Options:<span class="w"> </span>SAMEORIGIN
Alt-Svc:<span class="w"> </span><span class="nv">h3</span><span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-29<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q050<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q046<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q043<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,quic<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span><span class="p">;</span><span class="w"> </span><span class="nv">v</span><span class="o">=</span><span class="s2">&quot;46,43&quot;</span>


GET<span class="w"> </span>/<span class="w"> </span>HTTP/1.0
Host:<span class="w"> </span>www.google.com
Accept:<span class="w"> </span>*/*
Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate
User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>pc-x86_64-linux-gnu<span class="o">)</span><span class="w"> </span>Siege/4.0.4
Connection:<span class="w"> </span>close


HTTP/1.0<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">18</span><span class="w"> </span>May<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">13</span>:58:15<span class="w"> </span>GMT
Expires:<span class="w"> </span>-1
Cache-Control:<span class="w"> </span>private,<span class="w"> </span>max-age<span class="o">=</span><span class="m">0</span>
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8
P3P:<span class="w"> </span><span class="nv">CP</span><span class="o">=</span><span class="s2">&quot;This is not a P3P policy! See g.co/p3phelp for more info.&quot;</span>
Content-Encoding:<span class="w"> </span>gzip
Server:<span class="w"> </span>gws
Content-Length:<span class="w"> </span><span class="m">16549</span>
X-XSS-Protection:<span class="w"> </span><span class="m">0</span>
X-Frame-Options:<span class="w"> </span>SAMEORIGIN
Set-Cookie:<span class="w"> </span><span class="nv">1P_JAR</span><span class="o">=</span><span class="m">2022</span>-05-18-13<span class="p">;</span><span class="w"> </span><span class="nv">expires</span><span class="o">=</span>Fri,<span class="w"> </span><span class="m">17</span>-Jun-2022<span class="w"> </span><span class="m">13</span>:58:15<span class="w"> </span>GMT<span class="p">;</span><span class="w"> </span><span class="nv">path</span><span class="o">=</span>/<span class="p">;</span><span class="w"> </span><span class="nv">domain</span><span class="o">=</span>.google.com<span class="p">;</span><span class="w"> </span>Secure
Set-Cookie:<span class="w"> </span><span class="nv">AEC</span><span class="o">=</span>AakniGMdinGLKkNMlyftRpRAM4cMUqgUrRD_RwKDoO-zjrnh86-IVfvrZQ<span class="p">;</span><span class="w"> </span><span class="nv">expires</span><span class="o">=</span>Mon,<span class="w"> </span><span class="m">14</span>-Nov-2022<span class="w"> </span><span class="m">13</span>:58:15<span class="w"> </span>GMT<span class="p">;</span><span class="w"> </span><span class="nv">path</span><span class="o">=</span>/<span class="p">;</span><span class="w"> </span><span class="nv">domain</span><span class="o">=</span>.google.com<span class="p">;</span><span class="w"> </span>Secure<span class="p">;</span><span class="w"> </span>HttpOnly<span class="p">;</span><span class="w"> </span><span class="nv">SameSite</span><span class="o">=</span>lax
Set-Cookie:<span class="w"> </span><span class="nv">NID</span><span class="o">=</span><span class="nv">511</span><span class="o">=</span>iOqxShyPFsdByVNu1VRRvSkoaMtVo7rmFosEnMXXiNjV0csTcZMZasN5Ci61UHRngT75Id5lhl_XAwahXXfn9vaSnFExBF9WQDdd6V7u5jFL8uMPdjwdc4ztHk8PdERarunLE4kMNzc5ZprheXKLpTHw0xk_l8HGhmi86Exur8s<span class="p">;</span><span class="w"> </span><span class="nv">expires</span><span class="o">=</span>Thu,<span class="w"> </span><span class="m">17</span>-Nov-2022<span class="w"> </span><span class="m">13</span>:58:15<span class="w"> </span>GMT<span class="p">;</span><span class="w"> </span><span class="nv">path</span><span class="o">=</span>/<span class="p">;</span><span class="w"> </span><span class="nv">domain</span><span class="o">=</span>.google.com<span class="p">;</span><span class="w"> </span>HttpOnly
Alt-Svc:<span class="w"> </span><span class="nv">h3</span><span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-29<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q050<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q046<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q043<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,quic<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span><span class="p">;</span><span class="w"> </span><span class="nv">v</span><span class="o">=</span><span class="s2">&quot;46,43&quot;</span>


GET<span class="w"> </span>/images/branding/googlelogo/1x/googlelogo_white_background_color_272x92dp.png<span class="w"> </span>HTTP/1.0
Host:<span class="w"> </span>www.google.com
Cookie:<span class="w"> </span><span class="nv">1P_JAR</span><span class="o">=</span><span class="m">2022</span>-05-18-13<span class="p">;</span><span class="nv">AEC</span><span class="o">=</span>AakniGMdinGLKkNMlyftRpRAM4cMUqgUrRD_RwKDoO-zjrnh86-IVfvrZQ<span class="p">;</span><span class="nv">NID</span><span class="o">=</span><span class="nv">511</span><span class="o">=</span>iOqxShyPFsdByVNu1VRRvSkoaMtVo7rmFosEnMXXiNjV0csTcZMZasN5Ci61UHRngT75Id5lhl_XAwahXXfn9vaSnFExBF9WQDdd6V7u5jFL8uMPdjwdc4ztHk8PdERarunLE4kMNzc5ZprheXKLpTHw0xk_l8HGhmi86Exur8s
Accept:<span class="w"> </span>*/*
Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate
User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>pc-x86_64-linux-gnu<span class="o">)</span><span class="w"> </span>Siege/4.0.4
Connection:<span class="w"> </span>close


HTTP/1.0<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
Accept-Ranges:<span class="w"> </span>bytes
Content-Type:<span class="w"> </span>image/png
Cross-Origin-Resource-Policy:<span class="w"> </span>cross-origin
Cross-Origin-Opener-Policy-Report-Only:<span class="w"> </span>same-origin<span class="p">;</span><span class="w"> </span>report-to<span class="o">=</span><span class="s2">&quot;static-on-bigtable&quot;</span>
Report-To:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;group&quot;</span>:<span class="s2">&quot;static-on-bigtable&quot;</span>,<span class="s2">&quot;max_age&quot;</span>:2592000,<span class="s2">&quot;endpoints&quot;</span>:<span class="o">[{</span><span class="s2">&quot;url&quot;</span>:<span class="s2">&quot;https://csp.withgoogle.com/csp/report-to/static-on-bigtable&quot;</span><span class="o">}]}</span>
Content-Length:<span class="w"> </span><span class="m">5482</span>
Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">18</span><span class="w"> </span>May<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">13</span>:58:16<span class="w"> </span>GMT
Expires:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">18</span><span class="w"> </span>May<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">13</span>:58:16<span class="w"> </span>GMT
Cache-Control:<span class="w"> </span>private,<span class="w"> </span>max-age<span class="o">=</span><span class="m">31536000</span>
Last-Modified:<span class="w"> </span>Tue,<span class="w"> </span><span class="m">22</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2019</span><span class="w"> </span><span class="m">18</span>:30:00<span class="w"> </span>GMT
X-Content-Type-Options:<span class="w"> </span>nosniff
Server:<span class="w"> </span>sffe
X-XSS-Protection:<span class="w"> </span><span class="m">0</span>
Alt-Svc:<span class="w"> </span><span class="nv">h3</span><span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-29<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q050<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q046<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,h3-Q043<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span>,quic<span class="o">=</span><span class="s2">&quot;:443&quot;</span><span class="p">;</span><span class="w"> </span><span class="nv">ma</span><span class="o">=</span><span class="m">2592000</span><span class="p">;</span><span class="w"> </span><span class="nv">v</span><span class="o">=</span><span class="s2">&quot;46,43&quot;</span>

Transactions:<span class="w">                      </span><span class="m">3</span><span class="w"> </span>hits
Availability:<span class="w">                 </span><span class="m">100</span>.00<span class="w"> </span>%
Elapsed<span class="w"> </span>time:<span class="w">                   </span><span class="m">3</span>.83<span class="w"> </span>secs
Data<span class="w"> </span>transferred:<span class="w">               </span><span class="m">0</span>.02<span class="w"> </span>MB
Response<span class="w"> </span>time:<span class="w">                  </span><span class="m">1</span>.28<span class="w"> </span>secs
Transaction<span class="w"> </span>rate:<span class="w">               </span><span class="m">0</span>.78<span class="w"> </span>trans/sec
Throughput:<span class="w">                     </span><span class="m">0</span>.01<span class="w"> </span>MB/sec
Concurrency:<span class="w">                    </span><span class="m">1</span>.00
Successful<span class="w"> </span>transactions:<span class="w">           </span><span class="m">3</span>
Failed<span class="w"> </span>transactions:<span class="w">               </span><span class="m">0</span>
Longest<span class="w"> </span>transaction:<span class="w">            </span><span class="m">2</span>.37
Shortest<span class="w"> </span>transaction:<span class="w">           </span><span class="m">0</span>.70
</code></pre></div>

<p>همانطور که می‌بینید هدر‌های درخواست‌ها و پاسخ‌ها نیز در خروجی تست وجود دارند.</p>
<p>سوئیچ بعدی p- است. این سوئیچ همان کار سوئیچ قبلی را انجام می دهد و علاوه بر آن محتوای html ی صفحه را نیز بر میگرداند.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-p<span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>سوئیچ c- تعداد کاربران شبیه سازی شده را تعیین می کند. siege به صورت پیشفرض ۱۰ کاربر شبیه‌سازی شده را برای تست فراهم می‌کند.</p>
<p>مثال: تست با سه کاربر شبیه‌سازی شده:</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">3</span><span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>سوئیچ r- نشان‌دهنده تعداد تکرار درخواست‌های ارسالی است.</p>
<p>مثال: تست با یک کاربر شبیه‌سازی شده و با تعداد تکرار ۲:</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-r<span class="w"> </span><span class="m">2</span><span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>سوئیچ بعدی t- ،‌ زمان انجام تست را مشخص می کند.</p>
<p>مثال: تست برای دو کاربر همزمان شبیه‌سازی شده و به مدت ۱۰ ثانیه:</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-t<span class="w"> </span>10S<span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>برای مشخص کردن زمان انجام تست از سه فلگ S برای ثانیه،‌ M برای دقیقه و H برای ساعت استفاده می‌شود.  </p>
<p>سوئیچ بعدی d-  است که برای ایجاد یک تاخیر رندوم بین درخواست ها استفاده می‌شود البته می توانیم میزان تاخیر بین درخواست ها را نیز تعیین کنیم.</p>
<p>مثال:این تست برای ۲ کاربر همزمان شبیه سازی شده اجرا می‌شود هر کاربر ۳ بار درخواست را تکرار می کند و بین درخواست ها تاخیر یک ثانیه ای وجود دارد.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-r<span class="w"> </span><span class="m">3</span><span class="w"> </span>-d<span class="w"> </span>1S<span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>سوئیچ بعدی کاری مخالف سوئیچ تاخیر انجام می‌دهد. اگر ابزار با سوئیج b- اجرا شود،‌ هیچ تاخیری بین درخواست ها اتفاق نمی‌افتد و درخواست ها پشت سر هم به سرور ارسال می‌شوند. این سوئیچ برای بنچمارک گیری استفاده می‌شود.</p>
<p>مثال: این تست برای دوکاربر همزمان شبیه سازی شده و با تعداد تکرار پنج انجام می‌شود. درضمن تاخیری بین درخواست ها وجود ندارد.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-r<span class="w"> </span><span class="m">5</span><span class="w"> </span>-b<span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>سوئیچ بعدی i- که برای شبیه سازی یک کاربر معمولی استفاده می‌شود. هر کاربری که وارد یک سایت می‌شود با توجه به نیاز و علاقه مندی‌ خود ممکن است بر روی لینک های مختلفی کلیک کند. سوئیچ i- این رفتار کاربران را شبیه سازی می کند. پس وقتی که تست با این سوئیچ انجام شود، آدرس های مختلفی به صورت رندوم تست می شوند.</p>
<p>مثال: این تست برای دو کاربر همزمان و با تعداد تکرار یک و با شبیه سازی رفتار کاربران انجام می‌شود.</p>
<div class="highlight"><pre><span></span><code>‍siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span>-i<span class="w"> </span>-v<span class="w"> </span>https://google.com/
</code></pre></div>

<p>سوئیچ بعدی f- است. این سوئیچ برای تعیین مسیر فایلی که حاوی آدرس های مورد تست است، استفاده می‌شود. اگر فایلی با نام test.txt و محتوی دو آدرس به صورت زیر داشته باشیم،</p>
<div class="highlight"><pre><span></span><code><span class="nl">https:</span><span class="c1">//reganto.github.com/</span>
<span class="nl">https:</span><span class="c1">//google.com/</span>
</code></pre></div>

<p>در آن صورت تست به صورت زیر انجام می‌شود.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-t<span class="w"> </span>10S<span class="w"> </span>-v<span class="w"> </span>-f<span class="w"> </span>test.txt
</code></pre></div>

<p>تست برای دوکاربر شبیه سازی شده و در طی ۱۰ ثانیه بر روی دو آدرس موجود در فایل انجام می‌شود.
سوئیچ بعدی R- است. این سوئیچ برای معرفی یک siegerc فایل به ابزار استفاده می‌شود. اینگونه فایل ها دقیقا مشابه فایل bashrc هستند و با اجرای ابزار،‌ تنظیماتی را بر روی آن ابزار اعمال می کند. فایل siegerc پیش فرض در مسیر etc/siege/siegerc/ قرار دارد. می تونید این فایل را با یک ادیتور باز کنید و تنظیمات را تغییر دهید.(راهنمای هر دستور به صورت کامنت شده در فایل siegerc وجود دارد.)
سوئیچ بعدی l- است. این سوئیچ برای معرفی یک لاگ فایل به ابزار استفاده می‌شود تا ابزار لاگ‌های خود را در آن ثبت کند. اگر فایلی تعیین نشود،‌ لاگ ها به طور پیش فرش در var/log/siege.log/قرار می گیرند. برای معرفی یک لاگ فایل از آپشن لانگ یعنی log-- نیز می‌توان استفاده کرد. به مثال زیر توجه کنید:</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-t<span class="w"> </span>5S<span class="w"> </span>-v<span class="w"> </span>--log<span class="o">=</span>siege.log<span class="w"> </span>https://google.com/
</code></pre></div>

<p>تنظیمات کلی ابزار در مسیر  siege/siege.conf./~ قرار دارد.
سوئیچ بعدی m- و نوع لانگ آن mark-- است. این سوئیچ برای نشانه‌گذاری در لاگ فایل استفاده می‌شود و لاگ های مربوط به هر کاربر را با یک رشته از هم جدا می کند. شاید یک مثال به روشن شدن موضوع کمک کند. یک سرور آزمایشی ایجاد میکنم:</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">8001</span><span class="w"> </span>--bind<span class="o">=</span><span class="m">127</span>.0.0.1
</code></pre></div>

<p>البته می توانید تست را بر روی هر سرور دیگری نیز انجام دهید.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">2</span><span class="w"> </span>-t<span class="w"> </span>5S<span class="w"> </span>-v<span class="w"> </span>--log<span class="o">=</span>siege.log<span class="w"> </span>--mark<span class="o">=</span><span class="s2">&quot;aaaaa&quot;</span><span class="w"> </span>http://localhost:8001/
</code></pre></div>

<p>بعد از انجام تست، لاگ فایل را باز کنید.</p>
<div class="highlight"><pre><span></span><code>Date &amp; Time,  Trans,  Elap Time,  Data Trans,  Resp Time,  Trans Rate,  Throughput,  Concurrent,    OKAY,   Failed
2022-05-21 00:11:32,      7,       2.78,           0,       0.40,        2.52,        0.00,        1.00,       7,       0
**** aaaaa ****
2022-05-21 00:35:48,   1352,       4.40,           3,       0.01,      307.27,        0.68,        1.97,    1352,       0
</code></pre></div>

<p>همانطور که می بینید لاگ های مربوط به تست های مربوط به کاربران شبیه‌سازی مختلف با aaaaa از هم جدا شده اند. پس سوئیچ mark-- نقش یک delimiter«حائل» رو برای لاگ های مربوط به کاربران شبیه‌سازی‌شده مختلف در لاگ فایل  ایفا می‌کند.</p>
<p>سوئیچ بعدی H- و لانگ آن یعنی header-- است. این سوئیچ برای اضافه کردن یک هدر به درخواست استفاده می‌شود.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-t<span class="w"> </span>5S<span class="w"> </span>-v<span class="w"> </span>--header<span class="o">=</span><span class="s2">&quot;cache-control: no-cache&quot;</span><span class="w"> </span>http://localhost:8001/
</code></pre></div>

<p>لیستی از هدر‌های HTTP را می‌توانید <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields">اینجا</a> بیابید.
 با سوئیچ A- یا شکل لانگ آن user-agent-- می توان agent در خواست دهنده را مشخص کرد.  برای مشاهده‌ی لیستی از agentهای معروف می‌توانید به این <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">لینک</a> مراجعه بفرمایید.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span>-v<span class="w"> </span>-A<span class="o">=</span><span class="s2">&quot;curl/7.68.0&quot;</span><span class="w"> </span>http://localhost:8001/
</code></pre></div>

<p>اگر agent تعیین نشود، Mozilla/5.0 (pc-x86_64-linux-gnu) Siege/4.0.4 به صورت پیش فرض به عنوان agent ارسال می شود.
یکی دیگر از هدرهایی که نوع مدیای درون بدنه درخواست را تعیین می کند، هدرcontent-type است. ابزار Siege برای این هدر یک سوئیچ مجزا با نام T- یا content-type-- در نظر گرفته است. تست باید با سوئیچ g- انجام شود تا هدر درخواست و هدر پاسخ قابل مشاهده باشد.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-t<span class="w"> </span>5S<span class="w"> </span>-g<span class="w"> </span>-v<span class="w"> </span>--header<span class="o">=</span><span class="s2">&quot;content-type:application/json&quot;</span><span class="w"> </span>http://localhost:8001/
</code></pre></div>

<p>خروجی تست :</p>
<div class="highlight"><pre><span></span><code>HEAD<span class="w"> </span>/<span class="w"> </span>HTTP/1.0
Host:<span class="w"> </span>localhost:8001
Accept:<span class="w"> </span>/
Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate
User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>pc-x86_64-linux-gnu<span class="o">)</span><span class="w"> </span>Siege/4.0.4
content-type:<span class="w"> </span>application/json
Connection:<span class="w"> </span>close

HTTP/1.0<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
Server:<span class="w"> </span>SimpleHTTP/0.6<span class="w"> </span>Python/3.6.8
Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">10</span><span class="w"> </span>Jul<span class="w"> </span><span class="m">2019</span><span class="w"> </span><span class="m">16</span>:34:29<span class="w"> </span>GMT
Content-type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length:<span class="w"> </span><span class="m">418</span>
</code></pre></div>

<p><strong>Siege برای حملات DOS</strong></p>
<p>ابزار siege برای حملات  DOS نیز استفاده می‌شود. و اگر این حملات به صورت توزیع شده باشد،‌ حمله اصطلاحا <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack#Distributed_attack">DDOS</a> خواهد بود. برای جلوگیری از متهم شدن به حمله DOS تمام تست های این بخش بر روی سرور محلی انجام می‌شود. مانند مثال های قبل سرور محلی را با دستور زیر ایجاد می کنیم.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>http.server<span class="w"> </span><span class="m">8001</span><span class="w"> </span>--bind<span class="o">=</span><span class="m">127</span>.0.0.1
</code></pre></div>

<p>پس از اجرای سرور،‌ تست را انجام می دهیم.</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">255</span><span class="w"> </span>-r<span class="w"> </span><span class="m">10</span><span class="w"> </span>-v<span class="w"> </span>-b<span class="w"> </span>http://localhost:8001/
</code></pre></div>

<p>سوئیچ b- تاخیر بین درخواست ها را از بین می‌برد و از این طریق حمله موثرتر انجام خواهد شد!
البته به صورت پیش فرض تعداد کاربران شبیه سازی شده‌ی محدودی را می توانید استفاده کنید. این محدودیت را می تونید با باز کردن فایل کانفیگ siege یا فایل siegerc ببینید.(محدودیت در متغیر limit اعمال شده است) این نکته را هم باید مد نظر داشته باشید که سیستم برای هر درخواست کاربر شبیه سازی شده یک سوکت باز می کند.برای موثر بودن حمله مقدار سوئیچ‌های t- یا r- را تا حد معقولی افزایش دهید. برای جلوگیری از حملات DOS <a href="https://www.indusface.com/blog/top-6-ddos-attack-prevention-tactics-2021/">چندین راه مختلف وجود دارد</a>.</p>
<p><strong>استفاده از Siege برای ارسال دیتای POST</strong></p>
<p>از این قابلیت برای تست API ها استفاده می‌شود ولی با وجود ابزارهای قدرتمندی مانند Postman یا cURL شاید از استفاده از Siege چندان عاقلانه به نظر نرسد.در هر حال این قابلیت در siege وجود دارد. برای ارسال دیتای پست با Siege به صورت زیر عمل می کنیم:</p>
<div class="highlight"><pre><span></span><code>siege<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span>-r<span class="w"> </span><span class="m">1</span><span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;http://sample.com/ POST foo=bar&amp;baz=bash&#39;</span>
</code></pre></div>

<p>این دستور با یک کاربر شبیه سازی شده و تعداد تکرار یک، به آدرس فرضی sample.com دیتاهای foo=bar و baz=bash را ارسال می کند.</p>
<p><strong>مروری بر مهم‌ترین کانفیگ‌های Siege</strong></p>
<p>همان‌طور که قبلا اشاره شد کانفیگ ابزار در مسیر <code>etc/siege/siegerc/</code> قرار دارد. البته یک کپی از تنظیمات نیز در مسیر ‍<code>siege/siege.cong./~</code> وجود دارد. توضیحات مربوط به هر کانفیگ در قسمت بالای آن کانفیگ به صورت کامنت‌شده قرار دارد در این قسمت چند کانفیگ مهم را مرور خواهیم کرد.</p>
<p>درباره‌ی log در ابزار قبلا توضیح دادیم. <code>logfile</code> مسیر لاگ‌های ابزار را مشخص می‌کند. <code>verbose</code> همان سوئیچ v- است. <code>color</code> برای نمایش خروجی به صورت رنگی استفاده می‌شود و مقادیر آن به صورت on/off می‌باشد. <code>quiet</code> همان سوئیچ q- است. قبلا ذکر شد که اگر ابزار با سوئیچ g- اجرا شود، هدر درخواست و پاسخ نمایش داده می‌شود. تنظیم <code>gmethod</code> متدی را که ابزار در حالتی که با سوئیچ g- اجرا می‌شود را تعیین می کند. مقادیر این تنظیم GET/HEAD هستند. با متد HEAD فقط هدر درخواست و پاسخ نمایش داده می‌شود اما با متد GET تمام صفحه‌ای که درخواست به آن ارسال می‌شود، برگشت داده می‌شود و این دقیقا همان کاری‌ است که سوئیچ p- انجام می‌دهد. وقتی که درخواستی به یک سرور ارسال می‌شوداگر آپشن v- استفاده شده باشد، لاگ های ابزار در خروجی قرار می گیرند همچنین آدرس‌هایی که تست می‌شوند به صورت خلاصه شده در لاگ خروجی قرار می گیرند. با <code>fullurl</code> می توانیم خروجی لاگ‌ها را به صورت کامل نمایش دهیم. مقادیر این تنظیم به صورت true/false است. <code>protocol</code> پروتکل درخواست را مشخص می کند مقادیر آن می تواند HTTP/1.0 یا HTTP/1.1 باشد. در مورد HTTP/2.0 در مستندات اشاره‌ای نشده است. <code>concurrent</code> مشابه سوئیچ c- است. برای بعضی از تنظیمات،‌ سوئیچ‌های متناظری نیز در نظر گرفته شده است. تنظیم‌های <code>time</code> و <code>reps</code> و <code>file</code> و <code>dely</code> و <code>internet</code> و <code>benchmark</code> و سوئیچ‌های t- و ‍r- و f- و d- و i- و b- متناظر هستند.</p>
		</div>
	</div>
</div>
		</div>
		<div class="push"></div>
	</div>
	<div class="footer">
		<div class="container">
			<hr/>
				<ul class="nav nav-pills pull-right">
					<li><a href="https://github.com/reganto/">گیت‌هاب</a> </li>
					<li><a href="https://linkedin.com/in/murtazaselseleh/">لینکدین</a> </li>
					<li><a href="mailto:tell.reganto@gamil.com">تماس با من</a> </li>
				    <li><a href="/feeds/all.atom.xml">خبرخوان</a> </li>
				    <li><a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 - 2022</a> </li>
				</ul>
		</div>
	</div>
</body>
</html>